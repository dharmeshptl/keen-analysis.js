!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e){t.exports=function(t,e,n){var r;if(!t)return 0;if(n=n||t,t instanceof Array){for(r=0;r<t.length;r++)if(!1===e.call(n,t[r],r,t))return 0}else for(r in t)if(t.hasOwnProperty(r)&&!1===e.call(n,t[r],r,t))return 0;return 1}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])t[n]=arguments[e][n];return t}},function(t,e,n){"use strict";e.a=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})}},function(t,e,n){var r=n(0);n(2);t.exports=function(t){var e=[];return r(t,function(t,n){"string"!=typeof t&&(t=JSON.stringify(t)),e.push(n+"="+encodeURIComponent(t))}),e.join("&")}},function(t,e,n){"use strict";n.r(e),function(t){var e=n(6),r=n(3),o=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}();o.Promise?o.Promise.prototype.finally||(o.Promise.prototype.finally=r.a):o.Promise=e.a}.call(this,n(1))},function(t,e,n){"use strict";(function(t){var r=n(3),o=setTimeout;function i(){}function s(t){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function a(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,s._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void c(e.promise,t)}u(e.promise,r)}else(1===t._state?u:c)(e.promise,t._value)})):t._deferreds.push(e)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof s)return t._state=3,t._value=e,void f(t);if("function"==typeof n)return void l((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,f(t)}catch(e){c(t,e)}var r,o}function c(t,e){t._state=2,t._value=e,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&s._immediateFn(function(){t._handled||s._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,u(e,t))},function(t){n||(n=!0,c(e,t))})}catch(t){if(n)return;n=!0,c(e,t)}}s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){var n=new this.constructor(i);return a(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,n)),n},s.prototype.finally=r.a,s.all=function(t){return new s(function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var o=r.length;function i(t,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){i(t,e)},n)}r[t]=s,0==--o&&e(r)}catch(t){n(t)}}for(var s=0;s<r.length;s++)i(s,r[s])})},s.resolve=function(t){return t&&"object"==typeof t&&t.constructor===s?t:new s(function(e){e(t)})},s.reject=function(t){return new s(function(e,n){n(t)})},s.race=function(t){return new s(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},s._immediateFn="function"==typeof t&&function(e){t(e)}||function(t){o(t,0)},s._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},e.a=s}).call(this,n(16).setImmediate)},function(t,e,n){(function(t){(function(){"use strict";var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},o=function(){function t(){e(this,t),this.listeners={}}return n(t,[{key:"addEventListener",value:function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"removeEventListener",value:function(t,e){if(t in this.listeners)for(var n=this.listeners[t],r=0,o=n.length;r<o;r++)if(n[r]===e)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(t){var e=this;if(t.type in this.listeners){for(var n=function(n){setTimeout(function(){return n.call(e,t)})},r=this.listeners[t.type],o=0,i=r.length;o<i;o++)n(r[o]);return!t.defaultPrevented}}}]),t}(),i=function(t){function i(){e(this,i);var t=r(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.aborted=!1,t.onabort=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,o),n(i,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(t){"abort"===t.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,t)),function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var s=o.get;return void 0!==s?s.call(r):void 0}(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispatchEvent",this).call(this,t)}}]),i}(),s=function(){function t(){e(this,t),this.signal=new i}return n(t,[{key:"abort",value:function(){var t=void 0;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?(t=document.createEvent("Event")).initEvent("abort",!1,!1):t={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(s.prototype[Symbol.toStringTag]="AbortController",i.prototype[Symbol.toStringTag]="AbortSignal"),function(t){if(!t.AbortController)if(t.AbortController=s,t.AbortSignal=i,t.fetch){var e=function(t){"function"==typeof t&&(t={fetch:t});var e=t,n=e.fetch,r=e.Request,o=void 0===r?n.Request:r,i=e.AbortController,a=o;if(a){var u=(new(void 0===i?s:i)).signal;if(new a("/",{signal:u}).signal)return{fetch:n,Request:a};(a=function(t,e){var n=new o(t,e);return e&&e.signal&&(n.signal=e.signal),n}).prototype=o.prototype}var c=n;return{fetch:function(t,e){var n=a&&a.prototype.isPrototypeOf(t)?t.signal:e?e.signal:void 0;if(n){var r=void 0;try{r=new DOMException("Aborted","AbortError")}catch(t){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var o=new Promise(function(t,e){n.addEventListener("abort",function(){return e(r)},{once:!0})});return Promise.race([o,c(t,e)])}return c(t,e)},Request:a}}(t),n=e.fetch,r=e.Request;t.fetch=n,t.Request=r}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:t)})()}).call(this,n(1))},function(t,e){!function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(t){return t&&DataView.prototype.isPrototypeOf(t)},o=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};f.prototype.append=function(t,e){t=a(t),e=u(e);var n=this.map[t];this.map[t]=n?n+","+e:e},f.prototype.delete=function(t){delete this.map[a(t)]},f.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},f.prototype.set=function(t,e){this.map[a(t)]=u(e)},f.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},f.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),c(t)},f.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),c(t)},f.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),c(t)},e.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},y.call(m.prototype),y.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var s=[301,302,303,307,308];b.redirect=function(t,e){if(-1===s.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},t.Headers=f,t.Request=m,t.Response=b,t.fetch=function(t,n){return new Promise(function(r,o){var i=new m(t,n),s=new XMLHttpRequest;s.onload=function(){var t,e,n={status:s.status,statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;r(new b(o,n))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&e.blob&&(s.responseType="blob"),i.headers.forEach(function(t,e){s.setRequestHeader(e,t)}),s.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function c(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(n[Symbol.iterator]=function(){return n}),n}function f(t){this.map={},t instanceof f?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function l(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function d(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function p(t){var e=new FileReader,n=d(e);return e.readAsArrayBuffer(t),n}function h(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&r(t))this._bodyArrayBuffer=h(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!o(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=l(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var t,e,n,r=l(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=d(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(t,e){var n,r,o=(e=e||{}).body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),i.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function v(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function b(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DELETE=e.PUT=e.POST=e.GET=void 0,n(5),n(8),n(7);var r=i(n(0)),o=i(n(4));function i(t){return t&&t.__esModule?t:{default:t}}e.GET=function(t,e){return"undefined"!=typeof fetch?s("GET",t,e):a()?u("GET",t,e):c()?f("GET",t,e):function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,r=e.callback,i=(new Date).getTime(),s=document.createElement("script"),a=document.getElementsByTagName("head")[0],u="keenJSONPCallback",c=!1;u+=i;for(;u in window;)u+="a";window[u]=function(t){!0!==c&&f(null,t)},t.params&&(n+=(0,o.default)(t.params));function f(t,e){c=!0,r&&"function"==typeof r&&(r(t,e),r=void 0),window[u]=void 0;try{delete window[u]}catch(t){}a.removeChild(s)}s.onreadystatechange=function(){!1===c&&"loaded"===this.readyState&&f("An error occurred",null)},s.onerror=function(){!1===c&&f("An error occurred",null)},s.src=n+"&jsonp="+u,a.appendChild(s)}(t,e)},e.POST=function(t,e){if("undefined"!=typeof fetch)return s("POST",t,e);if(a())return u("POST",t,e);if(c())return f("POST",t,e);e.callback("XHR POST not supported",null)},e.PUT=function(t,e){if("undefined"!=typeof fetch)return s("PUT",t,e);if(a())return u("PUT",t,e);e.callback("XHR PUT not supported",null)},e.DELETE=function(t,e){if("undefined"!=typeof fetch)return s("DELETE",t,e);if(a())return u("DELETE",t,e);e.callback("XHR DELETE not supported",null)};function s(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={},s=e.url;return"GET"==t&&(s+="?",e.api_key&&(s+="api_key="+e.api_key+"&"),e.params&&(s+=(0,o.default)(e.params))),(0,r.default)(e.headers,function(t,e){"string"==typeof t&&(i[e]=t)}),"undefined"!=typeof AbortController&&(n.request.abortController=new AbortController),fetch(s,{method:t,body:"GET"!==t&&e.params?JSON.stringify(e.params):void 0,mode:"cors",headers:i,signal:n.request.abortController?n.request.abortController.signal:void 0}).then(function(t){return t.ok?t.json():t.json().then(function(e){return Promise.reject({error_code:e.error_code,body:e.message,status:t.status,ok:!1,statusText:t.statusText})})}).then(function(t){return void 0!==n.callback&&n.callback.call(self,null,t),Promise.resolve(t)})}function a(){var t="undefined"==typeof window?this:window;if(t.XMLHttpRequest&&(!t.ActiveXObject||t.location&&t.location.protocol&&"file:"!==t.location.protocol))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function u(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a(),s=n.callback,u=e.url;return i.onreadystatechange=function(){var t=void 0;if(4==i.readyState)if(i.status>=200&&i.status<300)if(204===i.status)s&&s(null,i);else try{t=JSON.parse(i.responseText),s&&t&&s(null,t)}catch(t){s&&s(i,null)}else try{t=JSON.parse(i.responseText),s&&t&&s(t,null)}catch(t){s&&s(i,null)}},"GET"!==t?(i.open(t,u,!0),(0,r.default)(e.headers,function(t,e){"string"==typeof t&&i.setRequestHeader(e,t)}),e.params?i.send(JSON.stringify(e.params)):i.send()):(u+="?",e.api_key&&(u+="api_key="+e.api_key+"&"),e.params&&(u+=(0,o.default)(e.params)),i.open(t,u,!0),(0,r.default)(e.headers,function(t,e){"string"==typeof t&&i.setRequestHeader(e,t)}),i.send()),i}function c(){var t="undefined"==typeof window?this:window;return!!t.XDomainRequest&&new t.XDomainRequest}function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=c(),i=n.callback;function s(t,e){i&&"function"==typeof i&&(i(t,e),i=void 0)}return r&&(r.timeout=e.timeout||3e5,r.ontimeout=function(){s(r,null)},r.onerror=function(){s(r,null)},r.onload=function(){s(null,JSON.parse(r.responseText))},r.open(t.toLowerCase(),e.url),setTimeout(function(){e.params?r.send((0,o.default)(e.params)):r.send()},0)),r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=a,e.getAnalysisType=u;var o=s(n(0)),i=s(n(2));function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return this.httpHandlers=e,function(e){return this.config={api_key:void 0,method:t,params:void 0,timeout:3e5,url:e,headers:{Authorization:"","Content-type":"application/json"}},this}.bind(this)}function u(t){var e=t.split("/queries/");return e[e.length-1]}a.prototype.auth=function(t){return"string"==typeof t&&(this.config.api_key="string"==typeof t?t:void 0,this.headers({Authorization:t})),this},a.prototype.headers=function(t){return"object"===(void 0===t?"undefined":r(t))&&(0,o.default)(t,function(t,e){this.config.headers[e]=t}.bind(this)),this},a.prototype.timeout=function(t){return this.config.timeout="number"==typeof t?t:3e5,this},a.prototype.send=function(t){this.config.params=t&&"object"===(void 0===t?"undefined":r(t))?t:{};var e=this.httpHandlers[this.config.method],n=(0,i.default)({},this.config),o=this;return void 0===n.params.analysis_type&&n.url.indexOf("/queries/")>-1&&n.url.indexOf("/saved/")<0&&(n.params.analysis_type=u(n.url)),new Promise(function(t,r){var s={callback:function(e,o){var s=o;e?r(e):(void 0!==n.params.event_collection&&void 0===o.query&&(s=(0,i.default)({query:n.params},o)),t(s))}};return s.request=o,e(n,s)})}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<r.length;o++)if((n=r[o])===e||n.fn===e){r.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){t.exports=function(t){var e,n={},r=/\+/g,o=/([^&=]+)=?([^&]*)/g,i=function(t){return decodeURIComponent(t.replace(r," "))},s=t.split("?")[1];for(;e=o.exec(s);)n[i(e[1])]=i(e[2]);return n}},function(t,e,n){(function(e){(function(e){var r=e.Keen||void 0,o=n(0),i=n(2),s=n(12),a=n(4),u=n(11);function c(t){if(this instanceof c==!1)return new c(t);this.configure(t),c.debug&&this.on("error",c.log),this.emit("ready"),c.emit("client",this)}function f(t){return void 0!==t}r&&void 0===r.resources&&(c.legacyVersion=r),u(c),u(c.prototype),i(c,{debug:!1,enabled:!0,loaded:!1,version:"__VERSION__"}),c.helpers=c.helpers||{},c.resources=c.resources||{},i(c.resources,{base:"{protocol}://{host}",version:"{protocol}://{host}/3.0",projects:"{protocol}://{host}/3.0/projects",projectId:"{protocol}://{host}/3.0/projects/{projectId}",events:"{protocol}://{host}/3.0/projects/{projectId}/events",queries:"{protocol}://{host}/3.0/projects/{projectId}/queries",datasets:"{protocol}://{host}/3.0/projects/{projectId}/datasets"}),c.utils=c.utils||{},i(c.utils,{each:o,extend:i,parseParams:s,serialize:a}),c.extendLibrary=function(t,e){var n=r||e;return f(n)&&f(n.resources)&&(o(n,function(e,n){"object"==typeof e?(t[n]=t[n]||{},i(t[n],e)):t[n]=t[n]||e}),i(t.prototype,n.prototype)),t},c.log=function(t){c.debug&&"object"==typeof console&&console.log("[Keen]",t)},c.noConflict=function(){return void 0!==e.Keen&&(e.Keen=c.legacyVersion||r),c},c.ready=function(t){c.loaded?t():c.once("ready",t)},c.prototype.configure=function(t){var e=t||{};return this.config=this.config||{projectId:void 0,writeKey:void 0,host:"api.keen.io",protocol:"https",requestType:"jsonp",resources:i({},c.resources)},"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1&&(e.protocol=document.location.protocol.replace(":","")),e.host&&e.host.replace(/.*?:\/\//g,""),i(this.config,e),this},c.prototype.masterKey=function(t){return arguments.length?(this.config.masterKey=t?String(t):null,this):this.config.masterKey},c.prototype.projectId=function(t){return arguments.length?(this.config.projectId=t?String(t):null,this):this.config.projectId},c.prototype.resources=function(t){if(!arguments.length)return this.config.resources;var e=this;return"object"==typeof t&&o(t,function(t,n){e.config.resources[n]=t||null}),e},c.prototype.url=function(t){var e,n=Array.prototype.slice.call(arguments,1),r=this.config.resources.base||"{protocol}://{host}";return e=t&&"string"==typeof t?this.config.resources[t]?this.config.resources[t]:r+t:r,o(this.config,function(t,n){"object"!=typeof t&&(e=e.replace("{"+n+"}",t))}),o(n,function(t,n){"string"==typeof t?e+="/"+t:"object"==typeof t&&(e+="?",o(t,function(t,n){e+=n+"="+t+"&"}),e=e.slice(0,-1))}),e},function(t){if(c.loaded||"undefined"==typeof document)return void t();null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),document.readyState="complete"},!1),document.readyState="loading");!function t(e){/in/.test(document.readyState)?setTimeout(function(){t(e)},9):e()}(t)}(function(){c.loaded=!0,c.emit("ready")}),t.exports=c}).call(this,"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{})}).call(this,n(1))},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],f=!1,l=-1;function d(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&p())}function p(){if(!f){var t=a(d);f=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new h(t,e)),1!==c.length||f||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,o,i,s,a,u=1,c={},f=!1,l=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){h(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){h(t.data)},r=function(t){i.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(o=l.documentElement,r=function(t){var e=l.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):r=function(t){setTimeout(h,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&h(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return c[u]=o,r(u),u++},d.clearImmediate=p}function p(t){delete c[t]}function h(t){if(f)setTimeout(h,0,t);else{var e=c[t];if(e){f=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{p(t),f=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(1),n(14))},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(15),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(1))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KeenAnalysis=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n(5);var o=a(n(13)),i=a(n(0)),s=a(n(2));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e){this.analysis=t,this.params={},this.set(e),void 0===this.params.timezone&&(this.params.timezone=-60*(new Date).getTimezoneOffset())}o.default.prototype.readKey=function(t){return arguments.length?(this.config.readKey=t?String(t):null,this):this.config.readKey},o.default.prototype.query=function(t,e){var n={};if(Promise.prototype.abort=function(){n.abortController&&n.abortController.abort(),n.abort&&n.abort()},t&&e&&"string"==typeof e)return e.indexOf("/result")<0&&(e+="/result"),(n=this.get(this.url("queries",t,e)).auth(this.readKey())).send();if("dataset"===t&&"object"===(void 0===e?"undefined":r(e)))return(n=this.get(this.url("datasets",e.name,"results")).auth(this.readKey())).send(e);if(t&&e&&"object"===(void 0===e?"undefined":r(e))){var o=(0,s.default)({analysis_type:t},e);return(n=this.post(this.url("queries",t)).auth(this.readKey())).send(o)}return t&&!e?Promise.reject({error_code:"SDKError",message:".query() called with incorrect arguments"}):void 0},o.default.Query=u,o.default.prototype.run=function(t,e){var n=this,r=e,a=void 0,u=t instanceof Array?t:[t],c=[];return(0,i.default)(u,function(t,e){var r=void 0;"string"==typeof t?r=n.query("saved",t+"/result"):t instanceof o.default.Query&&(r=n.query(t.analysis,(0,s.default)({analysis_type:t.analysis},t.params))),c.push(r)}),a=c.length>1?Promise.all(c):c[0],r&&(a.then(function(t){r(null,t)}),a.catch(function(t){r(t,null)})),a},u.prototype.set=function(t){var e=this;return(0,i.default)(t,function(t,n){var o=n,s=t;n.match(new RegExp("[A-Z]"))&&(o=n.replace(/([A-Z])/g,function(t){return"_"+t.toLowerCase()})),e.params[o]=s,s instanceof Array&&(0,i.default)(s,function(t,n){t instanceof Array==0&&"object"===(void 0===t?"undefined":r(t))&&(0,i.default)(t,function(t,r){if(r.match(new RegExp("[A-Z]"))){var i=r.replace(/([A-Z])/g,function(t){return"_"+t.toLowerCase()});delete e.params[o][n][r],e.params[o][n][i]=t}})})}),e},u.prototype.get=function(t){var e=t;if(e.match(new RegExp("[A-Z]"))&&(e=e.replace(/([A-Z])/g,function(t){return"_"+t.toLowerCase()})),this.params)return this.params[e]||null},u.prototype.addFilter=function(t,e,n){return this.params.filters=this.params.filters||[],this.params.filters.push({property_name:t,operator:e,property_value:n}),this};var c=e.KeenAnalysis=o.default;e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keen=void 0;s(n(2));var r=s(n(17)),o=s(n(10)),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(9));function s(t){return t&&t.__esModule?t:{default:t}}r.default.prototype.get=new o.default("GET",i),r.default.prototype.post=new o.default("POST",i),r.default.prototype.put=new o.default("PUT",i),r.default.prototype.del=new o.default("DELETE",i);var a=e.Keen=r.default.extendLibrary(r.default);e.default=a},function(t,e,n){t.exports=n(18)}])});
//# sourceMappingURL=keen-analysis.min.js.map